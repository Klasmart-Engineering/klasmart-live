syntax = "proto3";

message State {
    uint32 transitions = 0;
    Room room = 1;
}

message Room {
    repeated User teachers = 0;
    repeated User students = 1;
    string host = 2;
    Content content = 3;
    uint32 endTimestamp = 4;
}

message User {
    string id = 0;
    string name = 1;
    repeated Device devices = 2;
    repeated Trophy trophies = 3;
    repeated ChatMessage chatMessages = 4;
}

message Device {
    string id = 0; 
    string activityId = 1;
    string activityStreamId = 2;
    repeated WebRTCStream webRTCStreams = 3;
}

message WebRTCStream {
    string id = 0;
    string label = 1;
    repeated WebRTCTrack tracks = 2;
}

message WebRTCTrack {
    string id = 0;
    string sfu = 1;
}

message Trophy {
    string tropy = 0;
    uint32 timestamp = 1;
}

message ChatMessage {
    string message = 0;
    uint32 timestamp = 1;
}

message Content {
    enum Type {
        Blank = 0;
        WebRTCStream = 1;
        ActivityStream = 2;
        H5P = 3;
        Image = 4;
        Video = 5;
        Audio = 6;
    } 
    Type type = 0;
    string id = 1;
    string url = 2;
}